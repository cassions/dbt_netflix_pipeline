{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.7", "generated_at": "2024-10-27T18:50:00.569453Z", "invocation_id": "de1db92f-70f0-4dd5-bc6b-e6bd883d14e6", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-27T18:50:00.138747Z", "completed_at": "2024-10-27T18:50:00.173982Z"}, {"name": "execute", "started_at": "2024-10-27T18:50:00.181726Z", "completed_at": "2024-10-27T18:50:00.181726Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05855989456176758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.netflix_project.netflix_titles", "compiled": true, "compiled_code": "-- models/bronze/netflix_titles.sql\r\n\r\nSELECT\r\n  *\r\nFROM NETFLIX.RAW.NETFLIX_TITLES", "relation_name": "NETFLIX.BRONZE.netflix_titles"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-27T18:50:00.188725Z", "completed_at": "2024-10-27T18:50:00.214632Z"}, {"name": "execute", "started_at": "2024-10-27T18:50:00.215635Z", "completed_at": "2024-10-27T18:50:00.215635Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.029911041259765625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.netflix_project.atores", "compiled": true, "compiled_code": "-- models/silver/atores.sql\nWITH base AS (\n  SELECT DISTINCT\n    ROW_NUMBER() OVER (ORDER BY TRIM(actor_name)) AS \"ID\",\n    TRIM(actor_name) AS ACTOR,\n    LISTAGG(filme_title, ', ') WITHIN GROUP (ORDER BY filme_title) AS filmes\n  FROM (\n    SELECT\n        TRIM(actor.value) AS actor_name,  -- Nome correto para o ator\n        title AS filme_title\n    FROM\n        NETFLIX.BRONZE.netflix_titles,\n        LATERAL FLATTEN(input => SPLIT(\"CAST\", ', ')) AS actor  -- Corre\u00e7\u00e3o do FLATTEN\n    WHERE\n        actor.value IS NOT NULL AND actor.value != ''\n  ) AS flattened_actors\n  GROUP BY TRIM(actor_name)  -- Agrupar pelo nome correto\n)\nSELECT * FROM base", "relation_name": "NETFLIX.SILVER.atores"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-27T18:50:00.220632Z", "completed_at": "2024-10-27T18:50:00.225704Z"}, {"name": "execute", "started_at": "2024-10-27T18:50:00.241327Z", "completed_at": "2024-10-27T18:50:00.241327Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02269434928894043, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.netflix_project.diretores", "compiled": true, "compiled_code": "-- models/silver/diretores.sql\nWITH base AS (\n  SELECT DISTINCT\n    ROW_NUMBER() OVER (ORDER BY \"DIRECTOR\") AS \"ID\",\n    \"DIRECTOR\",\n    LISTAGG(\"FILME_TITLE\", ', ') AS filmes\n  FROM (\n    SELECT\n        TRIM(\"DIRECTOR\") AS \"DIRECTOR\",\n        \"TITLE\" AS \"FILME_TITLE\"\n    FROM\n        NETFLIX.BRONZE.netflix_titles,\n        LATERAL FLATTEN(input => SPLIT(\"DIRECTOR\", ', ')) AS \"DIRECTOR\"\n    WHERE\n        \"DIRECTOR\" IS NOT NULL AND \"DIRECTOR\" != ''\n)\nGROUP BY\n    \"DIRECTOR\"\n)\n\nSELECT * FROM base", "relation_name": "NETFLIX.SILVER.diretores"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-27T18:50:00.241327Z", "completed_at": "2024-10-27T18:50:00.256953Z"}, {"name": "execute", "started_at": "2024-10-27T18:50:00.256953Z", "completed_at": "2024-10-27T18:50:00.256953Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0156252384185791, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.netflix_project.filmes", "compiled": true, "compiled_code": "-- models/silver/filmes.sql\nWITH base AS (\n  SELECT DISTINCT\n    ROW_NUMBER() OVER (ORDER BY \"SHOW_ID\") AS \"ID\",\n    \"SHOW_ID\",\n    \"TITLE\",\n\t\"RELEASE_YEAR\",\n\t\"RATING\",\n\t\"DURATION\",\n\tTRY_TO_DATE(\"DATE_ADDED\", 'MMMM DD, YYYY') AS \"DATE_ADDED\",\n    \"DESCRIPTION\",\n\t\"COUNTRY\",\n\t\"TYPE\",\n\tSPLIT(\"LISTED_IN\", '.') AS \"LISTED_IN\"\n  FROM NETFLIX.BRONZE.netflix_titles\n)\n\nSELECT * FROM base", "relation_name": "NETFLIX.SILVER.filmes"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-27T18:50:00.256953Z", "completed_at": "2024-10-27T18:50:00.288202Z"}, {"name": "execute", "started_at": "2024-10-27T18:50:00.288202Z", "completed_at": "2024-10-27T18:50:00.288202Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.031249284744262695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.netflix_project.paises", "compiled": true, "compiled_code": "-- models/silver/paises.sql\nWITH base AS (\n  SELECT DISTINCT\n    ROW_NUMBER() OVER (ORDER BY country_cleaned) AS \"ID\",\n    country_cleaned AS \"COUNTRY\"\n  FROM (\n\t  SELECT distinct\n\t\t\tTRIM(SPLIT(country, ', ')[0]) AS country_cleaned\n\t\tFROM\n\t\t\tNETFLIX.BRONZE.netflix_titles\n\t\tWHERE\n\t\t\tcountry IS NOT NULL AND country != ''\n\t)\n  WHERE\n\t\tcountry_cleaned IS NOT NULL AND country_cleaned != ''\n)\nSELECT * FROM base", "relation_name": "NETFLIX.SILVER.paises"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-27T18:50:00.288202Z", "completed_at": "2024-10-27T18:50:00.303827Z"}, {"name": "execute", "started_at": "2024-10-27T18:50:00.303827Z", "completed_at": "2024-10-27T18:50:00.303827Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015624761581420898, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.netflix_project.tipos", "compiled": true, "compiled_code": "-- models/silver/tipos.sql\nWITH base AS (\n  SELECT DISTINCT\n    ROW_NUMBER() OVER (ORDER BY \"TYPE\") AS \"ID\",\n\t\"TYPE\"\n  FROM NETFLIX.BRONZE.netflix_titles\n  WHERE TYPE IS NOT NULL\n)\n\nSELECT * FROM base", "relation_name": "NETFLIX.SILVER.tipos"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-27T18:50:00.303827Z", "completed_at": "2024-10-27T18:50:00.350701Z"}, {"name": "execute", "started_at": "2024-10-27T18:50:00.350701Z", "completed_at": "2024-10-27T18:50:00.350701Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0468747615814209, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.netflix_project.dbt_utils_expression_is_true_filmes_RELEASE_YEAR___1900.620734e72f", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom NETFLIX.SILVER.filmes\n\nwhere not(RELEASE_YEAR > 1900)\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-27T18:50:00.350701Z", "completed_at": "2024-10-27T18:50:00.397575Z"}, {"name": "execute", "started_at": "2024-10-27T18:50:00.397575Z", "completed_at": "2024-10-27T18:50:00.397575Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04687356948852539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.netflix_project.not_null_filmes_RELEASE_YEAR.71a78f2109", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect RELEASE_YEAR\nfrom NETFLIX.SILVER.filmes\nwhere RELEASE_YEAR is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-27T18:50:00.397575Z", "completed_at": "2024-10-27T18:50:00.428828Z"}, {"name": "execute", "started_at": "2024-10-27T18:50:00.428828Z", "completed_at": "2024-10-27T18:50:00.428828Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03125309944152832, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.netflix_project.not_null_filmes_SHOW_ID.2bf31f2072", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect SHOW_ID\nfrom NETFLIX.SILVER.filmes\nwhere SHOW_ID is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-27T18:50:00.428828Z", "completed_at": "2024-10-27T18:50:00.444459Z"}, {"name": "execute", "started_at": "2024-10-27T18:50:00.460077Z", "completed_at": "2024-10-27T18:50:00.460077Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.031248807907104492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.netflix_project.not_null_filmes_TITLE.2d61ba99ee", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect TITLE\nfrom NETFLIX.SILVER.filmes\nwhere TITLE is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-27T18:50:00.460077Z", "completed_at": "2024-10-27T18:50:00.475707Z"}, {"name": "execute", "started_at": "2024-10-27T18:50:00.475707Z", "completed_at": "2024-10-27T18:50:00.475707Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01562976837158203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.netflix_project.unique_filmes_SHOW_ID.b67eaa2c5b", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    SHOW_ID as unique_field,\n    count(*) as n_records\n\nfrom NETFLIX.SILVER.filmes\nwhere SHOW_ID is not null\ngroup by SHOW_ID\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-27T18:50:00.491325Z", "completed_at": "2024-10-27T18:50:00.506951Z"}, {"name": "execute", "started_at": "2024-10-27T18:50:00.506951Z", "completed_at": "2024-10-27T18:50:00.506951Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015625953674316406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.netflix_project.CAMPANHA_DESENHOS_TERROR", "compiled": true, "compiled_code": "-- models/gold/CAMPANHA_FILMES_TERROR.sql\nWITH base AS (\n  SELECT \n    f.show_id,\n    f.title,\n    d.director,\n    a.actor,\n    p.country,\n    f.date_added,\n    f.release_year,\n    f.rating,\n    f.duration,\n    f.description,\n    f.listed_in\nFROM\n    NETFLIX.BRONZE.netflix_titles f\n    LEFT JOIN NETFLIX.SILVER.diretores d ON f.title = d.filmes\n    LEFT JOIN NETFLIX.SILVER.atores a ON f.title = a.filmes\n    LEFT JOIN NETFLIX.SILVER.paises p ON f.country = p.country\nWHERE\n    f.type = 'TV Show'\n    AND f.listed_in ILIKE '%Horror%'\n\tAND f.listed_in ILIKE '%Anime%'\n)\n\nSELECT * FROM base", "relation_name": "NETFLIX.GOLD.CAMPANHA_DESENHOS_TERROR"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-27T18:50:00.506951Z", "completed_at": "2024-10-27T18:50:00.538201Z"}, {"name": "execute", "started_at": "2024-10-27T18:50:00.538201Z", "completed_at": "2024-10-27T18:50:00.538201Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.netflix_project.CAMPANHA_FILMES_TERROR", "compiled": true, "compiled_code": "-- models/gold/CAMPANHA_FILMES_TERROR.sql\nWITH base AS (\n  SELECT \n    f.show_id,\n    f.title,\n    d.director,\n    a.actor,\n    p.country,\n    f.date_added,\n    f.release_year,\n    f.rating,\n    f.duration,\n    f.description,\n    f.listed_in\nFROM\n    NETFLIX.BRONZE.netflix_titles f\n    LEFT JOIN NETFLIX.SILVER.diretores d ON f.title = d.filmes\n    LEFT JOIN NETFLIX.SILVER.atores a ON f.title = a.filmes\n    LEFT JOIN NETFLIX.SILVER.paises p ON f.country = p.country\nWHERE\n    f.type = 'Movie'\n    AND f.listed_in ILIKE '%Horror%'\n)\n\nSELECT * FROM base", "relation_name": "NETFLIX.GOLD.CAMPANHA_FILMES_TERROR"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-27T18:50:00.538201Z", "completed_at": "2024-10-27T18:50:00.553830Z"}, {"name": "execute", "started_at": "2024-10-27T18:50:00.553830Z", "completed_at": "2024-10-27T18:50:00.553830Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015629291534423828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.netflix_project.CAMPANHA_SERIES_TERROR", "compiled": true, "compiled_code": "-- models/gold/CAMPANHA_SERIES_TERROR.sql\nWITH base AS (\n  SELECT \n    f.show_id,\n    f.title,\n    d.director,\n    a.actor,\n    p.country,\n    f.date_added,\n    f.release_year,\n    f.rating,\n    f.duration,\n    f.description,\n    f.listed_in\nFROM\n    NETFLIX.BRONZE.netflix_titles f\n    LEFT JOIN NETFLIX.SILVER.diretores d ON f.title = d.filmes\n    LEFT JOIN NETFLIX.SILVER.atores a ON f.title = a.filmes\n    LEFT JOIN NETFLIX.SILVER.paises p ON f.country = p.country\nWHERE\n    f.type = 'TV Show'\n--    AND ARRAY_TO_STRING(f.listed_in, ',') ILIKE '%Horror%'\n    AND f.listed_in ILIKE '%Horror%'\n)\n\nSELECT * FROM base", "relation_name": "NETFLIX.GOLD.CAMPANHA_SERIES_TERROR"}], "elapsed_time": 78.08212757110596, "args": {"use_colors": true, "log_level": "info", "favor_state": false, "defer": false, "vars": {}, "cache_selected_only": false, "invocation_command": "dbt docs generate", "exclude": [], "require_explicit_package_overrides_for_builtin_materializations": true, "show_resource_report": false, "log_path": "G:\\My Drive\\Pos\\MBA_DataEng_Impacta\\14_DataManagmentandGovernance\\dbt_netflix_pipeline\\netflix_project\\logs", "indirect_selection": "eager", "static": false, "introspect": true, "version_check": true, "log_format_file": "debug", "enable_legacy_logger": false, "printer_width": 80, "empty_catalog": false, "profiles_dir": "G:\\My Drive\\Pos\\MBA_DataEng_Impacta\\14_DataManagmentandGovernance\\dbt_netflix_pipeline\\netflix_project", "compile": true, "log_level_file": "debug", "partial_parse_file_diff": true, "send_anonymous_usage_stats": true, "source_freshness_run_project_hooks": false, "warn_error_options": {"include": [], "exclude": []}, "use_colors_file": true, "macro_debugging": false, "write_json": true, "log_file_max_bytes": 10485760, "log_format": "default", "partial_parse": true, "populate_cache": true, "print": true, "quiet": false, "select": [], "which": "generate", "require_resource_names_without_spaces": false, "strict_mode": false, "static_parser": true, "project_dir": "G:\\My Drive\\Pos\\MBA_DataEng_Impacta\\14_DataManagmentandGovernance\\dbt_netflix_pipeline\\netflix_project"}}